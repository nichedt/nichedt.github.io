<!DOCTYPE html>
<!-- index.html by Nicholas Tan -->
<!-- my first website -->

<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<div id='keypress_con'>
<canvas id="ctx" width="512" height="512" style="border:1px solid #000000;"></canvas>
</div>

<script>

    var ctx = document.getElementById("ctx").getContext("2d");
    ctx.fillStyle = 'pink';
    ctx.font = '30px Arial';
    ctx.globalAlpha = 0.5;

    var WIDTH = 512;
    var HEIGHT = 512;

    var snake = {
        head:{
            x:5*WIDTH/16,
            y:WIDTH/16,
            dir:39, //right
        },
        tail:{
            x:0,
            y:WIDTH/16,
            dir:39, //right
        },
        blockSize:WIDTH/16,
        borderSize:WIDTH/16/16,
        turnq:[],
    };

    ctx.fillRect(   snake.head.x+snake.borderSize       ,
                    snake.head.y+snake.borderSize       ,
                    snake.blockSize-snake.borderSize    ,
                    snake.blockSize-snake.borderSize    );
    ctx.fillRect(snake.tail.x,snake.tail.y,snake.blockSize,snake.blockSize);
    
    var frame = setInterval(update,500);
    
//function definitions
function update(){
    
    blockPosUpdate(snake.head);
    ctx.fillRect(    snake.head.x+snake.borderSize       ,
                     snake.head.y+snake.borderSize       ,
                     snake.blockSize-snake.borderSize    ,
                     snake.blockSize-snake.borderSize    );
    
    ctx.clearRect(snake.tail.x,snake.tail.y,snake.blockSize,snake.blockSize);
    
    blockPosUpdate(snake.tail);
    
    if(snake.turnq.length > 0){
        if( snake.turnq[0].x == snake.tail.x &&
            snake.turnq[0].y == snake.tail.y ){
            snake.tail.dir = snake.turnq.shift().dir;
        }
    }
    
    if(isDead()){
       clearInterval(frame);
    }
    
}

function isDead(){
    
	if( snake.head.x+snake.blockSize >= WIDTH    ||
		snake.head.x <= 0                        ||
		snake.head.y+snake.blockSize >= HEIGHT   ||
		snake.head.y <= 0                        ){
		return true;
	}
		
	if(snake.turnq.length > 0){

	}
	for(var i = 1; i < snake.turnq.length; i++){
		switch(snake.turnq[i].dir){
		case 37: //left
			if(snake.head.y == snake.turnq[i].y){
				if(	snake.turnq[i-1].x <= snake.head.x	&&
					snake.head.x <= snake.turnq[i].x	){
					return true;
				}
			}
			break;
		case 38: //up
			if(snake.head.x == snake.turnq[i].x){
				if(	snake.turnq[i-1].y <= snake.head.y 	&&
				   snake.head.y <= snake.turnq[i].y 	){
					return true;
				}
			}
			break;
		case 39: //right
			if(snake.head.y == snake.turnq[i].y){
				if(	snake.turnq[i].x <= snake.head.x 	&&
				   	snake.head.x <= snake.turnq[i-1].x 	){
					return true;
				}
			}
			break;
		case 40: //down
			if(snake.head.x == snake.turnq[i].x){
				if(	snake.turnq[i].y <= snake.head.y 	&&
				   	snake.head.y <= snake.turnq[i-1].y 	){
					return true;
				}
			}
			break;
		}
	}
	
	return false;
}

function collide(commonAxis, startCoord, endCoord){
	
}

function blockPosUpdate(block){
    switch(block.dir){
	case 37: //left
		block.x -= snake.blockSize;
		break;
	case 38: //up
		block.y -= snake.blockSize;
		break;
	case 39: //right
		block.x += snake.blockSize;
		break;
	case 40: //down
		block.y += snake.blockSize;
		break;
    }
}

$(function(){
    $('html').keydown(function(e){
        if( e.which >= 37 && e.which <=40   && //arrowkeys
            e.which+2 != snake.head.dir     && //not backwards
            e.which-2 != snake.head.dir     &&
            e.which   != snake.head.dir     ){ //not forwards
			snake.turnq.push({	x:snake.head.x,
							  	y:snake.head.y,
							  	dir:e.which,	});
            snake.head.dir = e.which;
        }
    });
});


</script>