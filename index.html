<!DOCTYPE html>
<!-- index.html by Nicholas Tan -->
<!-- my first website -->

<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<div id='keypress_con'>
<canvas id="ctx" width="512" height="512" style="border:1px solid #000000;"></canvas>
</div>

<script>

    var ctx = document.getElementById("ctx").getContext("2d");
    ctx.fillStyle = 'pink';
    ctx.font = '30px Arial';
    ctx.globalAlpha = 0.5;

    var WIDTH = 512;
    var HEIGHT = 512;

    var snake = {
        head:{
            x:5*WIDTH/16,
            y:WIDTH/16,
            dir:39, //right
        },
        tail:{
            x:0,
            y:WIDTH/16,
            dir:39, //right
        },
        blockSize:WIDTH/16,
        borderSize:WIDTH/16/16,
        turn:{
            q:[],
            xs:[],
            ys:[],
        }
    };

    ctx.fillRect(   snake.head.x+snake.borderSize       ,
                    snake.head.y+snake.borderSize       ,
                    snake.blockSize-snake.borderSize    ,
                    snake.blockSize-snake.borderSize    );
    ctx.fillRect(snake.tail.x,snake.tail.y,snake.blockSize,snake.blockSize);
    
    var frame = setInterval(update,500);
    
//function definitions
function update(){
    
    blockPosUpdate(snake.head);
    ctx.fillRect(    snake.head.x+snake.borderSize       ,
                     snake.head.y+snake.borderSize       ,
                     snake.blockSize-snake.borderSize    ,
                     snake.blockSize-snake.borderSize    );
    
    ctx.clearRect(snake.tail.x,snake.tail.y,snake.blockSize,snake.blockSize);
    
    blockPosUpdate(snake.tail);
    
    if(snake.turn.q.length != 0){
        if( snake.turn.xs[0] == snake.tail.x &&
            snake.turn.ys[0] == snake.tail.y ){
            snake.tail.dir = snake.turn.q.shift();
            snake.turn.xs.shift();
            snake.turn.ys.shift();
        }
    }
    
    if(isAlive(snake.head, snake.turn)){
       clearInterval(frame);
    }
    
}

function isAlive(block, turn){
    
	if( block.x+snake.blockSize >= WIDTH    ||
		block.x <= 0                        ||
		block.y+snake.blockSize >= HEIGHT   ||
		block.y <= 0                        ){
		return true;
	}
	
	for(var i = 1; i < turn.q.length; i++){
		
	}
}

function collide(block, startCoord, endCoord){
	
}

function blockPosUpdate(block){
    switch(block.dir){
        case 37: //left
            block.x -= snake.blockSize;
            break;
        case 38: //up
            block.y -= snake.blockSize;
            break;
        case 39: //right
            block.x += snake.blockSize;
            break;
        case 40: //down
            block.y += snake.blockSize;
            break;
    }
}

$(function(){
    $('html').keydown(function(e){
        if( e.which >= 37 && e.which <=40   && //arrowkeys
            e.which+2 != snake.head.dir     && //not backwards
            e.which-2 != snake.head.dir     &&
            e.which   != snake.head.dir     ){ //not forwards
            snake.turn.q.push(e.which);
				  console.log(snake.turn.q[snake.turn.q.length-1]);
            snake.turn.xs.push(snake.head.x);
				  console.log(snake.turn.xs[snake.turn.xs.length-1]);
            snake.turn.ys.push(snake.head.y);
				  console.log(snake.turn.ys[snake.turn.ys.length-1]);
            snake.head.dir = e.which;
        }
    });
});


</script>